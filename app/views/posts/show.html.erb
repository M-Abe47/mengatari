<div class="container">
  <div class="row mx-auto">
    <div class="mt-5 col-md-6">
      <%= attachment_image_tag @post, :image, :fill, 400, 300, fallback: "no_image.jpg", size: "400x300", class:"border rounded" %>
    </div>
    <div class="mt-5 col-md-6">
      <div>
        <%= link_to user_path(@post.user.id) do %>
          <%= attachment_image_tag @post.user, :image, :fill, 40, 40, fallback: "no_image.jpg", class:"rounded" %>
          <%= @post.user.name %>
        <% end %>
        <%= @post.created_at.strftime('%Y/%m/%d') %>
      </div>
      <h1 class="text item-text">
        <%= @post.title %>
      </h1>
      <p class="text"><%= @post.body %></p>
      <div>
        <div class="post-evaluation mt-5" data-score="<%= @post.evaluation %>"></div>
        <script>
          $('.post-evaluation').empty();
          $('.post-evaluation').raty({
            readOnly: true,
            score: function() {
              return $(this).attr('data-score');
            },
            path: '/assets'
          });
        </script>
        <% if user_signed_in? %>
          <div id="post_<%= @post.id %>" class="mt-3">
            <div class="favorite-btn"><%= render "favorites/favorite-btn", post: @post %></div>
          </div>
        <% elsif @post.user == current_user %>
          <%= link_to "削除", post_path(@post), method: :delete %>
          <%= link_to "編集", edit_post_path(@post) %>
        <% else %>
          <%= link_to "Sign up", new_user_registration_path, class:'btn btn-success' %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="row mt-5">
    <div class="mt-5 col-md-6"></div>
    <p>コメント件数：<%= @post.post_comments.count %></p>
    <% @post.post_comments.each do |post_comment| %>
      <%= post_comment.user.name %>
      <%= post_comment.created_at.strftime('%Y/%m/%d') %><%= post_comment.comment %>
    <% end %>
    <%= form_with(model:[@post, @post_comment], local: true) do |f| %>
      <%= f.text_area :comment, rows:'5',placeholder: "コメントをここに",class:"form-control" %>
      <%= f.submit "送信する" %>
    <% end %>
    <div class="mt-5 col-md-6"></div>
  </div>
</div>


