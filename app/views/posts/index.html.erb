<div class="container">
  <div class="row">
    <!--検索フォーム-->
    <%= form_with(url: search_posts_path, local: true, method: :get, class: "search-form") do |form| %>
      <%= form.text_field :keyword, placeholder: "投稿を検索する", class: "search-input" %>
      <%= form.submit "検索", class: "search-btn" %>
    <% end %>
  </div>
  <div class="row">
    <div class="col-3">
      <h3>人気の投稿</h3>
      <% @favorite_posts.each do |post| %>
      <tr>
        <td>
          <h3>
            <%= link_to post_path(post.id) do %>
              <%= post.title %>
            <% end %>
          </h3>
          <%= post.body %>
          <%= render "favorites/favorite-btn", post: post %>
          <%= post.user.name %>
          <div class="post-evaluation" data-score="<%= post.evaluation %>"></div>
        </td>
      </tr>
      <% end %>
    </div>
      <div class="col-9">
        <table>
          <thead></thead>
          <tbody>
            <% @posts.each do |post| %>
              <tr>
                <td>
                  <%= link_to post_path(post.id) do %>
                    <%= attachment_image_tag post, :image, :fill, 400, 300, fallback: "no_image.jpg", size: "400x300", class:"border rounded" %>
                  <% end %>
                </td>
                <td>
                  <h1><%= post.title %></h1>
                  <%= post.body %>
                  <%= render "favorites/favorite-btn", post: post %>
                  <%= post.user.name %>
                  <div class="post-evaluation" data-score="<%= post.evaluation %>"></div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
        <script>
          $('.post-evaluation').empty();
          $('.post-evaluation').raty({
            readOnly: true,
            score: function() {
              return $(this).attr('data-score');
            },
            path: '/assets'
          });
        </script>
      </div>
  </div>
</div>